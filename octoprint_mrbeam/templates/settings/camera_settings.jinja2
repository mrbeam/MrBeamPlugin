
<div id="settings_camera_calibration" class="scrollable" style="padding-bottom:2em; overflow-y: auto; height: calc(100vh - 100px);">
    <div id="camera_settings_view" class="scrollable">
		<h3>{{ _('Camera') }}</h3>
{#        <p>#}
{#            {{ _("Your Mr Beam's camera is factory calibrated by default, so there is normally no need to calibrate the camera.") }}#}
{#        </p>#}
{#        <div>#}
{#            {{ _("A new calibration of the camera is only necessary if:") }}#}
{#            <div>#}
{#                <ul>#}
{#                    <li>#}
{#                        {{ _("One of the pink markings has been changed. (For example, if the mark was peeled off and glued in again.)") }}#}
{#                    </li>#}
{#                    <li>#}
{#                        {{ _("You notice a larger deviation between the screen position on the adjusted (black-and-white image) and the laser result.") }}#}
{#                    </li>#}
{#                </ul>#}
{#            </div>#}
{#        </div>#}

        <div class="accordion md-accordion">
          <div class="card">
            <div class="card-header" id="settings_camera_calibration_status_header">
              <div>
                <button class="btn-link collapsed camera-status-collapsible requirement"
                        data-bind="css: readyToLaser.lid_fully_open() == true ? 'requirement-met' : 'requirement-not-met'"
                        type="button" data-toggle="collapse" data-target="#settings_camera_calibration_status"
                        aria-expanded="true" aria-controls="collapseOne">
                    {{ _('Status') }}
                </button>
              </div>
            </div>
            <div id="settings_camera_calibration_status" class="collapse" aria-labelledby="settings_camera_calibration_status_header">
              <div class="card-body">
                  <table class="camera-status-images" data-bind="visible: availablePicUrl()['raw']">
                      <tr>
                          <td><img data-bind="attr: {src: availablePicUrl()['raw']}"/></td>
                          <td><img data-bind="attr: {src: availablePicUrl()['lens_corrected']}"/></td>
                          <td><img data-bind="attr: {src: availablePicUrl()['cropped']}"/></td>
                      </tr>
                      <tr>
                          <td><strong>{{ _('Raw') }}</strong></td>
                          <td><strong>{{ _('Corrected') }}</strong></td>
                          <td><strong>{{ _('Cropped') }}</strong></td>
                      </tr>
                      <tr>
                          <td>{{ _('First picture') }}</td>
                          <td>{{ _('After lens calibration') }}</td>
                          <td>{{ _('Final, as shown in the working area') }}</td>
                      </tr>
                  </table>
                  <div data-bind="visible: !availablePicUrl()['raw']">
                      <p>{{ _('The camera is not able to take new pictures. Please check the following:') }}</p>
                  </div>
                  <ul class="camera-requirements">
                      <li class="requirement" data-bind="css: readyToLaser.lid_fully_open() == true ? 'requirement-met' : 'requirement-not-met'">
                          {{ _('The lid is open') }}</li>
                      <li class="requirement" data-bind="css: state.isOperational() ==  true ? 'requirement-met' : 'requirement-not-met'">
                          {{ _('Mr Beam is operational (no running laser jobs, homed)') }}</li>
                      <li class="requirement" data-bind="css: camera.markerState() == 4 ? 'requirement-met' : 'requirement-not-met'">
                          {{ _('The 4 markers are recognized') }}</li>
                      <ul data-bind="visible: camera.markerState() != 4">
                          <li>{{ _('Make sure that the gantry isn\'t blocking the sight --> Go to homing position') }}</li>
                      </ul>
                  </ul>
              </div>
            </div>
              <div class="camera-calibrations">
                  <div class="rounded_container calibration-container">
                      <div class="rounded_container_title">{{ _('LENS CALIBRATION') }}</div>
                      <hr class="rounded_container_hr">
                      <p>{{ _('The lens calibration is made to remove the fish-eye effect from the picture. Only do this if you think that your camera precision is bad, specially in the corners.') }}</p>
                      <button class="btn btn-default" data-bind="click: startLensCalibration">{{ _('Start') }}</button>
                  </div>
                  <div class="rounded_container calibration-container">
                      <div class="rounded_container_title">{{ _('CORNER CALIBRATION') }}</div>
                      <hr class="rounded_container_hr">
                      <p>{{ _('The corner calibration uses the pink markers to calibrate the camera. Use this in case one of the markers has been changed or if there is a large deviation between the screen position and the laser result.') }}</p>
                      <button class="btn btn-default" data-bind="click: changeUserView('corner')">{{ _('Start') }}</button>
                  </div>
              </div>
          </div>
        </div>

{#        <div class='calibration_manual text show_only_online'>{{ _("For more information, please have a look at our article on %(opening_tag)scamera calibration%(closing_tag)s.",#}
{#                opening_tag='<a href="https://mr-beam.freshdesk.com/support/solutions/articles/43000065908-camera-calibration" target="_blank"><i class="icon-external-link"></i>&nbsp;',#}
{#                closing_tag='</a>') }}</div>#}
{#        <div class='calibration_manual text show_only_offline'>{{ _("For more information, please have a look at our article on %(opening_tag)scamera calibration%(closing_tag)s.",#}
{#                opening_tag='<a href="#" onclick="mrbeam.openOfflineKbUrl(\'43000065908_camer_calibration.pdf\')"><i class="icon-file-text"></i>&nbsp;',#}
{#                closing_tag='</a>') }}</div>#}
{##}
{#        <div class='calibration_manual text show_only_online'>{{ _("Positioning with the Mr Beam camera is simple and fairly accurate,#}
{#        but there can be deviations of up to +/- 5mm. If a laser job needs to be positioned very accurately,#}
{#        we recommend using %(opening_tag)smanual positioning%(closing_tag)s.",#}
{#                opening_tag='<a href="https://mr-beam.freshdesk.com/support/solutions/articles/43000065874-manual-positioning" target="_blank"><i class="icon-external-link"></i>&nbsp;',#}
{#                closing_tag='</a>') }}</div>#}
{#        <div class='calibration_manual text show_only_offline'>{{ _("Positioning with the Mr Beam camera is simple and fairly accurate,#}
{#        but there can be deviations of up to +/- 5mm. If a laser job needs to be positioned very accurately,#}
{#        we recommend using %(opening_tag)smanual positioning%(closing_tag)s.",#}
{#                opening_tag='<a href="#" onclick="mrbeam.openOfflineKbUrl(\'43000065874_manual_positioning.pdf\')"><i class="icon-external-link"></i>&nbsp;',#}
{#                closing_tag='</a>') }}</div>#}
{#
        <div class='calibration_manual text'>
            {{ _("The following instructions will guide you step by step through the recalibration of your camera:") }}
        </div>#}
{#        <div>
			<button class="btn btn-default" data-bind="click: next">{{ _('Continue') }}</button>
		</div>#}
	</div>

    <div id="test_calibration_view" class="scrollable">
        TEST TEST TEST CALIBRATIOOOOOON
    </div>

    <div id="lens_calibration_view" class="scrollable">
        LENS CALIBRATIOOOOOON
        {% include 'calibration/user/view_lens_calibration.jinja2' %}
    </div>

    <div id="corner_calibration_view" class="scrollable">
        {% include 'calibration/user/view_corner_calibration.jinja2' %}
    </div>


{#	<div id="calibration_step_2" class="scrollable" data-bind="visible: !window.mrbeam.isWatterottMode()">#}
{#        <h3>{{ _('Camera Calibration') }}</h3>#}
{#		<div class='calibration_manual img' style='background-image:url(/plugin/mrbeam/static/img/calibration/calpic_material_size.svg)'></div>#}
{#		<div class='calibration_manual text'>{{_('Please put a material like cardboard inside your Mr Beam that it covers the whole working area.')}}</div>#}
{#		<div class='calibration_manual img' style='background-image:url(/plugin/mrbeam/static/img/calibration/calpic_close_lid.svg)'></div>#}
{#		<div class='calibration_manual text'>{{_('Close the lid. Mr Beam will start engraving the calibration markers on the cardboard.')}}</div>#}
{#		<div class='calibration_manual text'>{{_('Do not touch the engraved material. The camera will now take a picture of the engraving.') }}</div>#}
{#		<div>#}
{#			<button class="btn btn-primary" data-bind="click: engrave_markers">{{ _('Engrave Calibration Markers') }}</button>#}
{#			<button class="btn btn-default" data-bind="click: next">{{ _('Continue') }}</button>#}
{#		</div>#}
{#	</div>#}
{##}
{##}
{#	<div id="calibration_step_3" class="scrollable" data-bind="visible: !window.mrbeam.isWatterottMode()" style="overflow-y: auto; height: calc(100vh - 100px);">#}
{#        <h3>{{ _('Camera Calibration') }}</h3>#}
{#		<div class='calibration_manual img' style='background-image:url(/plugin/mrbeam/static/img/calibration/calpic_open_lid.svg)'></div>#}
{#		<div class='calibration_manual text'>{{_('Wait until the engraving is finished and Mr Beam illuminates green. Open the safety lid again') }}</div>#}
{#		<div class='calibration_manual img' style='background-image:url(/plugin/mrbeam/static/img/calibration/calpic_dont_touch.svg)'></div>#}
{#		<div class='calibration_manual text'>{{_('Do not touch the engraved material. The camera will now take a picture of the engraving.') }}</div>#}
{#		<div>#}
{#			<button class="btn btn-default" data-bind="click: continue_to_calibration">{{ _('Continue') }}</button>#}
{#		</div>#}
{#	</div>#}
{##}
{##}
{#	<div id="calibration_step_4" class="">#}
{#		<div class="calibration_manual" data-bind="css:{ text: !cornerCalibrationActive() }">#}
{#			{% include 'calibration/user/view_corner_calibration.jinja2' %}#}
{#		</div>#}
{#	</div>#}
</div>
